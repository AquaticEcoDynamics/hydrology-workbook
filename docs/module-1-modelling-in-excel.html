<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Module 1: Modelling in Excel | Environmental Dynamics Workbook</title>
  <meta name="description" content="The online Environmental Dynamics Workbook" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Module 1: Modelling in Excel | Environmental Dynamics Workbook" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The online Environmental Dynamics Workbook" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Module 1: Modelling in Excel | Environmental Dynamics Workbook" />
  
  <meta name="twitter:description" content="The online Environmental Dynamics Workbook" />
  

<meta name="author" content="Giles Knight, Matt Hipsey" />


<meta name="date" content="2020-07-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="GettingStarted.html"/>
<link rel="next" href="references.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><b>Environmental Dynamics Workbook</b></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="GettingStarted.html"><a href="GettingStarted.html"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="GettingStarted.html"><a href="GettingStarted.html#excel"><i class="fa fa-check"></i>Excel</a></li>
<li class="chapter" data-level="" data-path="GettingStarted.html"><a href="GettingStarted.html#r"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="GettingStarted.html"><a href="GettingStarted.html#unzipping-files"><i class="fa fa-check"></i>Unzipping files</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="module-1-modelling-in-excel.html"><a href="module-1-modelling-in-excel.html"><i class="fa fa-check"></i>Module 1: Modelling in Excel</a>
<ul>
<li class="chapter" data-level="" data-path="module-1-modelling-in-excel.html"><a href="module-1-modelling-in-excel.html#objectives"><i class="fa fa-check"></i>Objectives</a></li>
<li class="chapter" data-level="" data-path="module-1-modelling-in-excel.html"><a href="module-1-modelling-in-excel.html#what-is-an-environmental-flow"><i class="fa fa-check"></i>What is an environmental flow?</a></li>
<li class="chapter" data-level="" data-path="module-1-modelling-in-excel.html"><a href="module-1-modelling-in-excel.html#case-study"><i class="fa fa-check"></i>Case study</a></li>
<li class="chapter" data-level="" data-path="module-1-modelling-in-excel.html"><a href="module-1-modelling-in-excel.html#module-resources"><i class="fa fa-check"></i>Module resources</a></li>
<li class="chapter" data-level="" data-path="module-1-modelling-in-excel.html"><a href="module-1-modelling-in-excel.html#exercises"><i class="fa fa-check"></i>Exercises</a></li>
<li class="chapter" data-level="" data-path="module-1-modelling-in-excel.html"><a href="module-1-modelling-in-excel.html#submission"><i class="fa fa-check"></i>Submission</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Environmental Dynamics Workbook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="module-1-modelling-in-excel" class="section level1 unnumbered">
<h1>Module 1: Modelling in Excel</h1>
<h2>
Environmental Flows to an Estuary
</h2>
<div id="objectives" class="section level3 unnumbered">
<h3>Objectives</h3>
<p>Become familiar with basic spreadsheet commands in Excel by conducting an environmental flow analysis and building a simple impact model.</p>
</div>
<div id="what-is-an-environmental-flow" class="section level3 unnumbered">
<h3>What is an environmental flow?</h3>
<p>Lakes, rivers and estuaries are adapted to receive water based on the natural hydrological condition, but often water is required upstream for other purposes. An environmental flow is water that is provided to the environment to maintain its health and natural diversity</p>
</div>
<div id="case-study" class="section level3 unnumbered">
<h3>Case study</h3>
<center>
<div class="figure">
<img src="images/02-module1/picture1.jpeg" width="750" alt="" />
<p class="caption">Figure 1: Drain L inflows (yellow arrow) will be diverted (blue arrow)</p>
</div>
</center>
</div>
<div id="module-resources" class="section level3 unnumbered">
<h3>Module resources</h3>
<p>Download the Excel spreadsheet: <a href="./resources/module1/WEEK01_EnvFlowData.xls">MODULE01_EnvFlowData.xls</a></p>
</div>
<div id="exercises" class="section level3 unnumbered">
<h3>Exercises</h3>
<p>You are given a time-series of daily river flow and need to assess how different diversion scenarios impact the freshwater flow delivery to a down stream estuary.</p>
<ol style="list-style-type: decimal">
<li>For this flow time-series, calculate the <strong>volume of daily flow</strong> within the following bands
0-40; 40-80; 80-120; 120-200; 200-400; 400-1000; &gt;1000</li>
</ol>

<div class="rmdtip2">
Use a nested <code>IF()</code> statement in adjacent columns to partition flows
</div>
<center>
<video width="100%" height="100%" controls>
<source src="images/02-module1/video1.mp4" type="video/mp4">
</video>
</center>
<ol start="2" style="list-style-type: decimal">
<li>For this flow time-series, calculate the <strong>number of days</strong> daily flow within the above bands and work out <strong>annual average number of days</strong></li>
</ol>

<div class="rmdtip2">
Use <code>COUNT()</code> to get the number of entries in the column
</div>
<ol start="3" style="list-style-type: decimal">
<li>Calculate the <strong>annual amount of flow</strong> in total and in each band</li>
</ol>
<p>You may do the annual averaging manually or the pivot table method. For the pivot table method: Insert a new column B, Label it Year.
Type the year number into the first cell, make sure it is formatted as a number.</p>
<center>
<video width="100%" height="80%" controls>
<source src="images/02-module1/video2.mp4" type="video/mp4">
</video>
</center>
<p>Click two times on the little square in the corner of the box. This will fill down the page.
Repeat this at each year change and you will have the year only information which you can then use to summarise data. As the original date has day numbers and decimal time each one is unique so you end up with a record for each day. This way you get a record for each year.</p>

<div class="rmdtip2">
Use <code>YEAR()</code> to speed this step up
</div>
<p>Highlight all the data. It must have headings for each column or it won’t work.
Go to “Insert” then “Pivot Table”. Click OK as you want the default settings.
Then you just fiddle until you get what you want. The following is an example:</p>
<center>
<video width="90%" height="90%" controls>
<source src="images/02-module1/video3.mp4" type="video/mp4">
</video>
</center>
<ol start="4" style="list-style-type: decimal">
<li><strong>Sort the years</strong> from highest to lowest flow:
<ol style="list-style-type: lower-alpha">
<li>Add a new column next to the flows indexing the years sequentially (i.e. 1, 2, 3…)</li>
<li>Add a new column next to the indices calculating the probability of meeting the annual flow: <span class="math inline">\(P(Yri) = \frac{i}{\text{number of years}+1}\)</span></li>
</ol></li>
</ol>
<center>
<video width="100%" height="100%" controls>
<source src="images/02-module1/video4.mp4" type="video/mp4">
</video>
</center>
<div class="line-block">           c. Scatter plot the flow vs probability curve</div>

<div class="rmdtip2">
Sum each year
</div>
<ol start="5" style="list-style-type: decimal">
<li>Assess the amount of water available for <strong>flow diversion for two scenarios</strong> by adding a new time-series column for each option:
<ol style="list-style-type: lower-alpha">
<li>Water below 50 ML/day and above 550 ML/day is NOT diverted</li>
<li>Water below 150 ML/day and above 1000 ML/day is NOT diverted</li>
</ol></li>
<li>Add two new columns for each of the above to work out <strong>cumulative amount</strong> of diverted water
<ol style="list-style-type: lower-alpha">
<li><span class="math inline">\(X^{+1} = X +dX\)</span></li>
</ol></li>
<li>Create a scatter plot of historical salinity (as EC) collected from the site marked in the map (+) vs daily discharge from the drain (see sheet: Estuary – Salinity).</li>
<li>Fit a trendline to the data and display equation and R<sup>2</sup> – this is a statistical model.</li>
<li>In a new time-series column in the previous sheet, use the statistical model from above to predict a salinity time-series for the above station in the estuary under the two diversion scenarios compared to the base case.</li>
</ol>
</div>
<div id="submission" class="section level3 unnumbered">
<h3>Submission</h3>
<div class="redbox2">
<p><strong>Submit properly formatted graphs and tables of the following sections of the lab:</strong></p>
<ul>
<li>Q2: Table of the number of days daily flow within the above bands and annual average
number of days</li>
<li>Q3: Table of the annual amount of flow in total and in each band</li>
<li>Q4: Table of annual flow by year with index and probability. Scatter plot of the flow vs
probability curve</li>
<li>Q6: Table of the cumulative amount of diverted water</li>
<li>Q7 &amp; 8: Scatterplot of the EC vs. daily discharge from the drain, with trendline, equation and
R2 value</li>
<li>Q9: Plot of the salinity timeseries of the two diversion scenarios compared to the base case</li>
<li>In less than 100 words, discuss which is the most appropriate scenario choice for
management of the estuary</li>
</ul>
<p>These are in a word doc or PDF format. No screenshots of figures from Excel/Excel
spreadsheets to be uploaded</p>
<p><strong>General professional formatting guidelines:</strong></p>
<ul>
<li>All figures are to have adequate captions explaining them</li>
<li>For graphs, figure captions go below the plot</li>
<li>For tables, the caption goes above the table</li>
<li>Make sure figures and their text size is readable</li>
</ul>
<p><strong>Excel hints:</strong></p>
<ul>
<li>When there is a caption for a plot, you remove the title</li>
<li>Remove the plot border and gridlines</li>
<li>Make sure both axes have visible lines and tick marks</li>
<li>Units need to be noted properly with the axis label - ‘Temperature (°C)’</li>
<li>Round numbers to be reasonable</li>
</ul>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="GettingStarted.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "none"
},
"search": true,
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
